# -*- coding: utf-8 -*-
# Created by Takuya Ono
# see: https://hub.docker.com/r/nodered/node-red-docker/

version: '3.7'
services:

  node-red:
    #  <node-red-version>-<node-version>-<image-type>
    #image: nodered/node-red:1.3.2-10-minimal
    image: nodered/node-red$VERSION
    restart: always
    environment:
    # See: https://github.com/node-red/node-red-docker/blob/master/docker-custom/Dockerfile.custom
    #- NODE_RED_ENABLE_SAFE_MODE=true
    - NODE_RED_ENABLE_PROJECTS=true
    #- FLOWS=flows.json
    #- NODE_OPTIONS=--max-old-space-size=1456
    - NODE_OPTIONS=${NODE_OPTIONS}
    #
    - TZ="Asia/Tokyo"
#    - GOOGLE_APPLICATION_CREDENTIALS=/data/adc.json
    #Secret Variablesはgitlab-ciのときだけ
    - GOOGLE_CLOUD_PROJECT=${GOOGLE_CLOUD_PROJECT}
    user: $CUID:$CGID
    volumes:
    - /etc/localtime:/etc/localtime:ro
    - /etc/letsencrypt:/etc/letsencrypt:ro
    - ./data:/data
#    ports:
#    - "1880:1880"
    networks:
      default:
        ipv4_address: $IP_ADDRESS
    hostname: node-red

networks:
  default:
    ipam:
      driver: default
      config:
      - subnet: $NETWORK

